language: python
python:
- '3.6'
- '3.7'
install:
- pip install -r requirements.txt
- pip install .
script:
- pytest
stages:
  - name: after_deploy
    # require the branch name to be master (note for PRs this is the base branch name)
    if: branch = continous_integration
deploy:
  - provider: pypi
    user: "__token__"
    server: https://test.pypi.org/legacy/
    # if we would like to have nightly builds, add egg_info --tag-build=dev --tag-date 
    distributions: "sdist bdist_wheel"
    skip_existing: true
    on:
      branch: develop
    password:
      secure: CTuFiBybWGK63YEvLmYRr3xVwf2Qc/CrAy6BZv0qVsg3dhwUchcCt5XpkLAbuM6RYW8vMqf4S/Oq04TGlGvjeSyO2Bfcp9vJBrU4MY63O5W61UgVZixL8UE6cFFGctJ7+JfUqjGIMZKDy8Qj6us7rhnKpdXGc8NWEzdCYBInOTaY9wO0zM3zL11VTF2T7dZ0s7pJy8tnAeUI1Nkc57m/JCCe1OheYEIl9wC3GlPAKSvRCEA9a5eGa1EHchMfCFdcHlXSEFxEcAl7Y+UkZp2nI//Ym9Fdv3dN1c+hh7/8gCWz0d5PPPpbeeqTx0DhOnpbVsooKdK2cSiaXCdAucwnLOZpUjhwIQUroDpbDcF+NinyJBc5c+E3KxkHyRiX+9HgB+4pmf8j24C3n7CTI+f5KZoFpg/uRp4LjNamdUUiGYoPw+rajmW4gh/5CC4wSa4t07Jw/v8U14pJnYM2Anb+FMYOhkZRtSZBvGEpZC9KNHuHeLIUCBn35NIEvvNNimRR+tZ+nRQiFhTxYB+2PrcXUx3slC/FMRZTfV5QUMxaVNg8oLX3dXIwqGLNQXlOv52lgFQkS1Sp6ioXRMurzGYh5tzKdiAx/6B1oF/Xq8NQBmNh2B840YlS+ODG5bNsVhhp0DQf71NJ5m3W+Uv70LaqBPdcHdYIrFyd9Fz7HS6XlGo=
  - provider: pypi
    user: "__token__"
    distributions: "sdist bdist_wheel"
    skip_existing: true
    on:
      branch: master
    password:
      secure: F8LIgT/69wl3XeMvt2bNR2JuYxOtgqe/MNkKWbOA7TreAniMQ3lYEv067sZO5bdcOKBR7VDqzbeCukdYcXr28lUQ8+fG5fO3jRm6INrKKy7Sjn1uJbP+h7HWRAe8tUeG0eLjfKnZVpYJH/Tif3LCRzza1hnKGVCDvKTgbplRumj8AGEOmwH+bQY+FltvIg8sUU1F0Zf3h0VmzXofW7szAULX5M9kAsMnLnDbNsleDUSnVsyBA26ARXCVB59kK2461wvoh/zbB0XulE7YwRNfqHAm2p5YhJ4ydHlHXzqZAe14MOgNtujYoRkeTdlXX3AN7ZLl4hktjVAUNv/O/VOEAtSEHwZLIhxciGEZb5Zs5NMzv3nx9/Fyu21zvH1CXVOLV7QFGpbpTpj4ljGA0gQrNyEVLit7YJgLxDjQku4678byLVvVldu+wOANpuapCsDLisggAZXyQpJgXZS6REj7j1Yff+AG46GK89EhKF0Z0KcR3SjXRgIiO1KohehwluHAAlzzyzyGxJ1RBch6KwOo9LmfYdbJXQiR/Dj8LM5d82vBZ4yOTE5ONLTyR0soJ6WVwGhpe4WL14HFRf1GnHW5wgQpUKWLarS/Z8sDt3Bkk0fcUtskaPO/9hiUJ8hHCIz2o4r7fzswL8ZpNbEqsmya95XCZRBHAfLHTcp2uH3oY2I=
after_deploy:
  - git config --global user.email "builds@travis-ci.com"
  - git config --global user.name "Travis CI"
  - export GIT_TAG=$(cat VERSION.txt)
  - git tag $GIT_TAG -a -m "Generated tag from TravisCI build $TRAVIS_BUILD_NUMBER"
  - git push origin $GIT_TAG
